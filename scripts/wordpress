#!/bin/sh

# WordPress Setup
# ===============

create()
{
  curl -O http://wordpress.org/latest.tar.gz
  tar -xzvf latest.tar.gz
  rm latest.tar.gz
  rm wordpress/readme.html
  rm wordpress/index.php
  curl -O https://raw.github.com/gist/2235543/277da1154c5520e099808b1b508e45efd458c76a/index.php
  rm wordpress/wp-config-sample.php
  curl -O https://raw.github.com/gist/2235543/507bd7a1e9cd1f6c04a4713d165becbc73e1979d/wp-config.php
  mv wordpress/wp-content wp-content
  rm wp-content/plugins/hello.php
  mkdir uploads
  chmod 755 uploads
}

secret() {
  curl https://api.wordpress.org/secret-key/1.1/salt | pbcopy
  echo "\ncopied to clipboard"
}

usage()
{
  cat << __EOT

  WordPress Install
  =================

  Usage:

    wordpress <name>

      Where <name> is the name you'd like to use for the project, e.g., Bacon
      For multi-word project names simply wrap <name> in quotes, e.g., 'Chunky Bacon'

      Structure:
        <name>
        - uploads/
        - wordpress/
        - wp-content/
        - wp-config.php
        - index.php

    wordpress --secret

      Copies generate keys and salts from https://api.wordpress.org/secret-key/1.1/salt to clipboard

__EOT
  exit 1
}

if [ "$1" == "--secret" ] && [ -z "$2"]; then
  secret
elif [ -z "$1" ] || [ "$1" == "--help" ] || [ "$1" == "-h" ] && [ -z "$2"]; then
  usage
else
  if [ -d "$1" ]; then
    echo "Directory already exists"
  else
    mkdir "$1"
    cd "$1"
    create
    echo "Project \""$1"\" succesfully created"

  fi
fi